"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[981],{9080:function(e,t,n){var i;n.d(t,{Y:function(){return i}}),(i||(i={})).Point={WebSocket:"/api/ws",GetGetGameState:"/api/get-get-game-state",PostExistsDeviceId:"/api/post-exists-device-id",PostCheckPlayerAlive:"/api/post-check-player-alive",PostSaveNewGame:"/api/post-save-new-game",PostExistsEntryDeviceId:"/api/post-exists-entry-device-id",PostCheckDuplEntryPlayerName:"/api/post-check-dupl-entry-player-name",PostPlayerTempRegist:"/api/post-player-temp-regist",PostPlayerRegist:"/api/post-player-regist",PostPlayerRegistRemove:"/api/post-player-regist-remove",GetExecAllPlayerRemove:"/api/get-exec-all-player-remove",GetExecAllEntryRemove:"/api/get-exec-all-entry-remove",GetExecEntryRegist:"/api/get-exec-entry-regist",PostChangeGameState:"/api/post-change-game-state",GetFetchAllPlayerInfo:"/api/get-fetch-all-player-info",PostSelfRoleChecked:"/api/post-self-role-checked"}},4666:function(e,t,n){n.d(t,{D:function(){return i}});let i={Empty:"Empty",PreGame:"PreGame",PlayerJoining:"PlayerJoining",PlayerJoiningEnded:"PlayerJoiningEnded",PlayerListDisplay:"PlayerListDisplay",RoleAssignment:"RoleAssignment",DayPhaseStart:"DayPhaseStart",DayPhase:"DayPhase",DayPhaseEnd:"DayPhaseEnd",Voting:"Voting",VotingEnd:"VotingEnd",VoteResult:"VoteResult",ExileAnnouncement:"ExileAnnouncement",FinalExileAnnouncement:"FinalExileAnnouncement",NightPhaseStart:"NightPhaseStart",NightPhase:"NightPhase",NightPhaseEnd:"NightPhaseEnd",MorningPhaseStart:"MorningPhaseStart",NightActionResult:"NightActionResult",GameEnd:"GameEnd",FinalResult:"FinalResult",RoleReveal:"RoleReveal"}},6349:function(e,t,n){n.d(t,{X:function(){return i}});let i={All:"All",Server:"Server",AllSite:"AllSite",GameMasterSite:"GameMasterSite",MonitorSite:"MonitorSite",PlayerSite:"PlayerSite",Player:"Player",None:"None",Empty:"Empty"}},810:function(e,t,n){n.d(t,{g:function(){return i}});let i={Empty:"Empty",NoAction:"NoAction",GameStateUpdate:"GameStateUpdate",GameScreenChange:"GameScreenChange",CountdownTimerStart:"CountdownTimerStart",CountdownTimerPause:"CountdownTimerPause",CountdownTimerResume:"CountdownTimerResume",ReturnCurrentGameState:"ReturnCurrentGameState",RoleRegistration:"RoleRegistration",ExileVoteRegistration:"ExileVoteRegistration",SurveyRegistration:"SurveyRegistration",SeerActionExecute:"SeerActionExecute",MediumActionExecute:"MediumActionExecute",HunterActionExecute:"HunterActionExecute",WerewolfAttackVote:"WerewolfAttackVote",SurvivorInfoDisplay:"SurvivorInfoDisplay",WerewolfAttackVoteInfoDisplay:"WerewolfAttackVoteInfoDisplay",PlayerEliminationInfoDisplay:"PlayerEliminationInfoDisplay",SpectatorEliminationInfoDisplay:"SpectatorEliminationInfoDisplay",VoteResultInfoDisplay:"VoteResultInfoDisplay",FinalResultInfoDisplay:"FinalResultInfoDisplay",RoleListInfoDisplay:"RoleListInfoDisplay",GameMasterGameInfoDisplay:"GameMasterGameInfoDisplay",GameEnd:"GameEnd"}},7499:function(e,t,n){n.d(t,{t:function(){return i}});let i={Server:"Server",GameMasterSite:"GameMasterSite",MonitorSite:"MonitorSite",PlayerSite:"PlayerSite",Debug:"Debug"}},2861:function(e,t,n){n.d(t,{O:function(){return i}});var i,o=n(2797),r=n(1872);!function(e){function registerIfNotExists(){let e=o.n.getDeviceId();if(void 0==e){let e=(0,r.Z)();o.n.setDeviceId(e)}}function get(){var e;registerIfNotExists();let t=null!==(e=function(){let e=o.n.getDeviceId();return e}())&&void 0!==e?e:"";return t}e.registerIfNotExists=registerIfNotExists,e.get=get,e.getToAPIData=function(){let e=get();return{deviceId:e}}}(i||(i={}))},2797:function(e,t,n){var i,o,r,a;n.d(t,{n:function(){return o}});let s={jrptGeneralDeviceid:"jrpt_general_deviceid",jrptNewgameMode:"jrpt_newgame_mode",jrptEntryPlayername:"jrpt_entry_playername",jrptEntryPlayericon:"jrpt_entry_playericon"};(r=i||(i={})).get=function(e){let t=localStorage.getItem(e);if(null!=t)return t},r.set=function(e,t){localStorage.setItem(e,t)},(a=o||(o={})).getDeviceId=function(){let e=i.get(s.jrptGeneralDeviceid);return e},a.setDeviceId=function(e){i.set(s.jrptGeneralDeviceid,e)},a.getNewGameMode=function(){let e=i.get(s.jrptNewgameMode);return e},a.getForPostNewGameMode=function(){let e=i.get(s.jrptNewgameMode);return{gameMode:e}},a.setNewGameMode=function(e){i.set(s.jrptNewgameMode,e)},a.getEntryPlayerName=function(){let e=i.get(s.jrptEntryPlayername);return e},a.setEntryPlayerName=function(e){i.set(s.jrptEntryPlayername,e)},a.getEntryPlayerIcon=function(){let e=i.get(s.jrptEntryPlayericon);return e},a.setEntryPlayerIcon=function(e){i.set(s.jrptEntryPlayericon,e)}},5981:function(e,t,n){n.d(t,{r:function(){return WsService}});var i,o,r,a,s,l=n(810),c=n(6349),u=n(3085),d=n.n(u),g=n(9080),f=n(7499),p=n(2861);let y=new Map([[f.t.GameMasterSite,[c.X.All,c.X.AllSite,c.X.GameMasterSite]],[f.t.MonitorSite,[c.X.All,c.X.AllSite,c.X.MonitorSite]],[f.t.PlayerSite,[c.X.All,c.X.AllSite,c.X.PlayerSite,c.X.Player]],[f.t.Debug,[c.X.All,c.X.Server,c.X.AllSite,c.X.GameMasterSite,c.X.MonitorSite,c.X.PlayerSite,c.X.Player]]]);var m=n(4666);(i=r||(r={})).get=function(e){let t=sessionStorage.getItem(e);if(null!=t)return t},i.set=function(e,t){sessionStorage.setItem(e,t)};let S={jrptGeneralSessionid:"jrpt_general_sessionid"};(o=a||(a={})).getSessionId=function(){let e=r.get(S.jrptGeneralSessionid);return e},o.setSessionId=function(e){r.set(S.jrptGeneralSessionid,e)};var P=n(1872);!function(e){function registerIfNotExists(){let e=a.getSessionId();if(void 0==e){let e=(0,P.Z)();a.setSessionId(e)}}e.registerIfNotExists=registerIfNotExists,e.get=function(){var e;registerIfNotExists();let t=null!==(e=function(){let e=a.getSessionId();return e}())&&void 0!==e?e:"";return t}}(s||(s={}));let WsService=class WsService{openWebSocket(){let e=g.Y.Point.WebSocket,t="".concat("http://localhost:8080").concat(e);if(void 0==t){this.socket=void 0;return}console.log("SockJS Before..."),console.log(this.socket);let n=s.get();this.socket=new(d())(t,null,{sessionId:()=>n}),console.log("SockJS After..."),console.log(this.socket),this.socket.addEventListener("open",e=>{console.log("WebSocket connected."),this.setWsIsOpenFunc(!0)}),this.socket.addEventListener("message",e=>{console.log("WebSocket Receive...");let t=JSON.parse(e.data);this.needsRendering(t)&&(console.log(t),this.setReceiveDataFunc(t))}),this.socket.addEventListener("close",e=>{console.log("WebSocket disconnected.")})}needsRendering(e){if(!this.isAllowedDestinationTypes(e)||!this.isSendToMe(e))return!1;if(this.selfInfo.selfSenderType===f.t.Debug&&e.requestAction===l.g.ReturnCurrentGameState)return!0;switch(e.requestAction){case l.g.GameScreenChange:if(this.includeConst(e.actionParameter01,m.D))return!0;break;case l.g.CountdownTimerStart:case l.g.CountdownTimerPause:case l.g.CountdownTimerResume:case l.g.SurvivorInfoDisplay:case l.g.WerewolfAttackVoteInfoDisplay:case l.g.PlayerEliminationInfoDisplay:case l.g.SpectatorEliminationInfoDisplay:case l.g.VoteResultInfoDisplay:case l.g.FinalResultInfoDisplay:case l.g.RoleListInfoDisplay:case l.g.GameMasterGameInfoDisplay:return!0}return!1}isAllowedDestinationTypes(e){let t=e.destinationType,n=this.selfInfo.allowedDestinationTypes;for(let e of n)if(t===e)return!0;return!1}isSendToMe(e){return e.destinationType!==c.X.Player||e.destinationDeviceId===this.selfInfo.selfDeviceId}generateSelfInfo(e){let t=p.O.get(),n=y.get(e);void 0==n&&(n=[c.X.Empty]);let i={selfSenderType:e,selfDeviceId:t,allowedDestinationTypes:n};return i}includeConst(e,t){for(let n of Object.values(t))if(e===n)return!0;return!1}send(e){if(void 0==this.socket)return;let t=JSON.stringify(e);this.socket.send(t)}getCurrentGameState(){let e={destinationType:c.X.Server,destinationDeviceId:"",senderType:this.selfInfo.selfSenderType,senderDeviceId:this.selfInfo.selfDeviceId,requestAction:l.g.ReturnCurrentGameState,actionParameter01:"",actionParameter02:"",actionParameter03:""};this.send(e)}updateGameState(e){let t={destinationType:c.X.Server,destinationDeviceId:"",senderType:this.selfInfo.selfSenderType,senderDeviceId:this.selfInfo.selfDeviceId,requestAction:l.g.GameStateUpdate,actionParameter01:e,actionParameter02:"",actionParameter03:""};this.send(t)}constructor(e,t,n){this.setWsIsOpenFunc=t,this.setReceiveDataFunc=n,this.selfInfo=this.generateSelfInfo(e),this.openWebSocket();return}}}}]);